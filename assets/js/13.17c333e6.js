(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{371:function(a,s,e){"use strict";e.r(s);var r=e(42),t=Object(r.a)({},(function(){var a=this,s=a.$createElement,e=a._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h1",{attrs:{id:"集群配置与管理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#集群配置与管理"}},[a._v("¶")]),a._v(" 集群配置与管理")]),a._v(" "),e("p",[a._v("除了正确启动和停止集群以外，我们还需要在Hadoop集群上运行基准测试。")]),a._v(" "),e("p",[a._v("我们可以使用基准测试结果调整集群，以从中获得最佳性能。")]),a._v(" "),e("p",[a._v("为了获得最佳结果，我们应该在未被使用过的集群上运行基准测试。")]),a._v(" "),e("p",[a._v("Hadoop附带了多个基准测试，我们可以以最低的设置成本非常轻松地运行这些程序。")]),a._v(" "),e("p",[a._v("基准打包在JAR文件中，我们可以通过不带任何参数的方式调用JAR文件来获得带有描述的基准列表：")]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("hadoop jar hadoop-mapreduce-jobclient-3.2.0-test.jar\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"/images/hadoop/1.jpg",alt:"1.jpg"}})]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("hadoop jar hadoop-mapreduce-client-jobclient-3.2.0-tests.jar\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"/images/hadoop/2.jpg",alt:"2.jpg"}})]),a._v(" "),e("h3",{attrs:{id:"使用testdfsio测试hdfs的i-o性能"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用testdfsio测试hdfs的i-o性能"}},[a._v("¶")]),a._v(" 使用TestDFSIO测试HDFS的I/O性能：")]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("hadoop jar hadoop-mapreduce-client-jobclient-3.2.0-tests.jar TestDFSIO\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"/images/hadoop/3.jpg",alt:"3.jpg"}})]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("hadoop jar hadoop-mapreduce-client-jobclient-3.2.0-tests.jar TestDFSIO -write -nrFiles "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),a._v(" -fileSize "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v("\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("hadoop jar hadoop-mapreduce-client-jobclient-3.2.0-tests.jar TestDFSIO -read -nrFiles "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),a._v(" -fileSize "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v("\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("hadoop jar hadoop-mapreduce-client-jobclient-3.2.0-tests.jar TestDFSIO -clean\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("h2",{attrs:{id:"hdfs的nnbench测试-namenode基准-nnbench"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#hdfs的nnbench测试-namenode基准-nnbench"}},[a._v("¶")]),a._v(" HDFS的NNbench测试[NameNode基准(nnbench)]:")]),a._v(" "),e("p",[a._v("NNBench（由nnbench调用）对于负载测试namenode硬件很有用。\nNNBench可以在HDFS上创建，读取，重命名和删除文件。")]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("hadoop jar hadoop-mapreduce-client-jobclient-3.2.0-tests.jar nnbench -help\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"/images/hadoop/4.jpg",alt:"4.jpg"}})]),a._v(" "),e("h3",{attrs:{id:"使用10个mapper和5个reducer创建1000个文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用10个mapper和5个reducer创建1000个文件"}},[a._v("¶")]),a._v(" 使用10个mapper和5个reducer创建1000个文件：")]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("hadoop jar hadoop-mapreduce-client-jobclient-3.2.0-tests.jar nnbench -operation create_write -maps "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),a._v(" -reduces "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" -numberOfFiles "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v(" -replicationFactorPerFile "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(" -readFileAfterOpen "),e("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),a._v("\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("h2",{attrs:{id:"mrbench测试-mapreduce基准测试-mrbench"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mrbench测试-mapreduce基准测试-mrbench"}},[a._v("¶")]),a._v(" MRbench测试[MapReduce基准测试(mrbench)]")]),a._v(" "),e("p",[a._v("MRBench（使用mrbench调用）多次运行一个小的作业，以测试集群是否可以有效地处理少量的作业。")]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("hadoop jar hadoop-mapreduce-client-jobclient-3.2.0-tests.jar mrbench -help\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"/images/hadoop/5.jpg",alt:"5.jpg"}})]),a._v(" "),e("p",[a._v("做一个小任务10次:")]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("hadoop jar hadoop-mapreduce-client-jobclient-3.2.0-tests.jar mrbench -numRuns "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v("\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("hr"),a._v(" "),e("p",[a._v("这对于将HDFS和MapReduce一起进行基准测试非常有用，因为完整的输入数据集是通过改组传输的.")]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("hadoop jar hadoop-mapreduce-examples-3.2.0.jar\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"/images/hadoop/6.jpg",alt:"6.jpg"}})]),a._v(" "),e("p",[a._v("运行wordcount例子：")]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("hadoop fs -mkdir /wordcount\nhadoop fs -mkdir /wordcount/input\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br")])]),e("p",[a._v("将文件放到input文件夹：")]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("hadoop fs -put test.txt /wordcount/input\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[a._v("test.txt文件夹内容如下图所示：")]),a._v(" "),e("p",[e("img",{attrs:{src:"/images/hadoop/8.jpg",alt:"8.jpg"}})]),a._v(" "),e("p",[a._v("执行：")]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("hadoop jar hadoop-mapreduce-examples-3.2.0.jar wordcount /wordcount/input /wordcount/output\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"/images/hadoop/7.jpg",alt:"7.jpg"}})]),a._v(" "),e("p",[a._v("查看结果：")]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("hadoop fs -cat /wordcount/output/part-r-00000\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"/images/hadoop/9.jpg",alt:"9.jpg"}})]),a._v(" "),e("h3",{attrs:{id:"使用terasort来评测hdfs"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用terasort来评测hdfs"}},[a._v("¶")]),a._v(" 使用TeraSort来评测HDFS")]),a._v(" "),e("p",[a._v("Hadoop自带一个名为"),e("em",[a._v("TeraSort")]),a._v("的MapReduce程序，该程序对输入进行全排序。由于全部输入数据集通过shuffle传输，所以TeraSort对于同时评测HDFS和MapReduce非常有用。测评分为三步：生成随机数据、执行排序和验证结果。")]),a._v(" "),e("p",[a._v("执行程序：")]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("hadoop jar hadoop-mapreduce-examples-3.2.0.jar teragen "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("10000")]),a._v(" /terasort/input\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"/images/hadoop/10.jpg",alt:"10.jpg"}})]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("hadoop jar hadoop-mapreduce-examples-3.2.0.jar terasort /terasort/input /terasort/output\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"/images/hadoop/11.jpg",alt:"11.jpg"}})]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("hadoop jar hadoop-mapreduce-examples-3.2.0.jar teravalidate /terasort/output /terasort/report\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"/images/hadoop/12.jpg",alt:"12.jpg"}})]),a._v(" "),e("h5",{attrs:{id:"进入与退出安全模式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#进入与退出安全模式"}},[a._v("¶")]),a._v(" 进入与退出安全模式")]),a._v(" "),e("p",[a._v("查看当前的模式：")]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("hdfs dfsadmin -safemode get\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[a._v("用户期望在执行某条命令之前namenode先退出安全模式，特别是在脚本中。使用wait选项能够达到这个目的：")]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("hdfs dfsadmin -safemode "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("wait")]),a._v("\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[a._v("进入安全模式：")]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("hdfs dfsadmin -safemode enter\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[a._v("退出安全模式：")]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("hdfs dfsadmin -safemode leave\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[a._v("文件系统检查(fsck)")]),a._v(" "),e("p",[a._v("用于检查HDFS中文件的运行状况。")]),a._v(" "),e("p",[a._v("该工具查找所有数据节点中缺少的块以及复制不足或过度的块。")]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("hdfs "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("fsck")]),a._v(" /\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"/images/hadoop/13.jpg",alt:"13.jpg"}})]),a._v(" "),e("p",[a._v("HDFS操作语句")]),a._v(" "),e("p",[a._v("查看文件：")]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("hadoop fs -cat /directory/filename\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[a._v("删除文件：")]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("hadoop fs -rm -r /directory\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[a._v("创建文件夹：")]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("hadoop fs –mkdir /directory\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[a._v("将本地文件放到HDFS路径下：")]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("hadoop fs –put /localfile /hdfs/directory\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[a._v("从HDFS获取文件到本地路径下：")]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("hadoop fs –get /hdfs/directory/filename /localpath/\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[a._v("将本地文件复制到HDFS路径下：")]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("hadoop fs –copyFromLocal /localfile /hdfs/directory\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[a._v("将HDFS文件复制到本地路径下：")]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("hadoop fs –copyToLocal /hdfs/directory/filename /localpath/\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])])])}),[],!1,null,null,null);s.default=t.exports}}]);