<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Pig | Hadoop</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="Hadoop 学习笔记">
    
    <link rel="preload" href="/assets/css/0.styles.bea26999.css" as="style"><link rel="preload" href="/assets/js/app.7696aff8.js" as="script"><link rel="preload" href="/assets/js/2.3c301967.js" as="script"><link rel="preload" href="/assets/js/22.8c1d8730.js" as="script"><link rel="preload" href="/assets/js/11.7aea8a94.js" as="script"><link rel="prefetch" href="/assets/js/10.239320ff.js"><link rel="prefetch" href="/assets/js/12.a75c9a92.js"><link rel="prefetch" href="/assets/js/13.17c333e6.js"><link rel="prefetch" href="/assets/js/14.c658bd9d.js"><link rel="prefetch" href="/assets/js/15.adf41b6f.js"><link rel="prefetch" href="/assets/js/16.d09250f7.js"><link rel="prefetch" href="/assets/js/17.3a4cbbc8.js"><link rel="prefetch" href="/assets/js/18.a7d27d96.js"><link rel="prefetch" href="/assets/js/19.3f563a7b.js"><link rel="prefetch" href="/assets/js/20.cf7aaa65.js"><link rel="prefetch" href="/assets/js/21.dabe57d5.js"><link rel="prefetch" href="/assets/js/23.b9917a11.js"><link rel="prefetch" href="/assets/js/24.095af618.js"><link rel="prefetch" href="/assets/js/25.d294f37a.js"><link rel="prefetch" href="/assets/js/26.fc764424.js"><link rel="prefetch" href="/assets/js/27.998a5d50.js"><link rel="prefetch" href="/assets/js/28.7d6e20a5.js"><link rel="prefetch" href="/assets/js/29.d2921661.js"><link rel="prefetch" href="/assets/js/3.566e47d9.js"><link rel="prefetch" href="/assets/js/4.23282b51.js"><link rel="prefetch" href="/assets/js/5.c842d990.js"><link rel="prefetch" href="/assets/js/6.ef414eb3.js"><link rel="prefetch" href="/assets/js/7.3152689a.js"><link rel="prefetch" href="/assets/js/8.530be27e.js"><link rel="prefetch" href="/assets/js/9.a4f965b7.js">
    <link rel="stylesheet" href="/assets/css/0.styles.bea26999.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Hadoop</span></a> <div class="links"><!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="/hadoop/install.html" class="nav-link">
  Hadoop
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/hadoop/install.html" class="nav-link">
  Hadoop
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/hadoop/install.html" class="sidebar-link">安装</a></li><li><a href="/hadoop/benchmark.html" class="sidebar-link">集群配置与管理</a></li><li><a href="/hadoop/hdfs.html" class="sidebar-link">HDFS</a></li><li><a href="/hadoop/io.html" class="sidebar-link">Hadoop I/O</a></li><li><a href="/hadoop/mapreduce.html" class="sidebar-link">MapReduce</a></li><li><a href="/hadoop/mysql.html" class="sidebar-link">MySQL</a></li><li><a href="/hadoop/sqoop.html" class="sidebar-link">Sqoop</a></li><li><a href="/hadoop/hive.html" class="sidebar-link">Hive</a></li><li><a href="/hadoop/hbase.html" class="sidebar-link">HBase</a></li><li><a href="/hadoop/pig.html" aria-current="page" class="active sidebar-link">Pig</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/hadoop/pig.html#介绍" class="sidebar-link">介绍</a></li><li class="sidebar-sub-header"><a href="/hadoop/pig.html#安装" class="sidebar-link">安装</a></li><li class="sidebar-sub-header"><a href="/hadoop/pig.html#使用实例" class="sidebar-link">使用实例</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/hadoop/pig.html#filter操作" class="sidebar-link">Filter操作</a></li><li class="sidebar-sub-header"><a href="/hadoop/pig.html#join操作" class="sidebar-link">Join操作</a></li><li class="sidebar-sub-header"><a href="/hadoop/pig.html#order-by操作" class="sidebar-link">Order by操作</a></li><li class="sidebar-sub-header"><a href="/hadoop/pig.html#group操作" class="sidebar-link">Group操作</a></li></ul></li></ul></li><li><a href="/hadoop/spark.html" class="sidebar-link">Spark</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="pig"><a href="#pig" class="header-anchor">¶</a> Pig</h1> <h2 id="介绍"><a href="#介绍" class="header-anchor">¶</a> 介绍</h2> <p>Pig是一个基于Hadoop的大规模数据分析平台，它提供的SQL-LIKE语言叫Pig Latin，该语言的编译器会把类SQL的数据分析请求转换为一系列经过优化处理的MapReduce运算。Pig为复杂的海量数据并行计算提供了一个简单的操作和编程接口。</p> <p>pig的特点：</p> <ol><li>专注于于大量数据集分析；</li> <li>运行在集群的计算架构上，Yahoo Pig 提供了多层抽象，简化并行计算让普通用户使用；这些抽象完成自动把用户请求queries翻译成有效的并行评估计划，然后在物理集群上执行这些计划；</li> <li>提供类似 SQL 的操作语法；</li> <li>开放源代码；</li></ol> <h2 id="安装"><a href="#安装" class="header-anchor">¶</a> 安装</h2> <p>如果本来是root用户，先切换成hadoop用户：su hadoop。</p> <p>把pig-0.17.0.tar.gz传到虚拟机内（路径自己选，我是保存在/home/hadoop/pig下），进入保存的路径：cd  /home/hadoop/pig。</p> <p>在当前路径下，解压缩pig-0.17.0.tar.gz ：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>tar  -zxvf  pig-0.17.0.tar.gz
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>注意：在hadoop用户可能提示没有权限，无法解压，此时要切换成root用户(su root)，再进行解压缩，压缩完成之后，记得要再切换成hadoop用户，因为我们所有的操作都是在hadoop用户下进行的。</p></div> <p>配置环境变量：vim  /etc/profile</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token builtin class-name">export</span> <span class="token assign-left variable">PIG_HOME</span><span class="token operator">=</span>/home/hadoop/pig/pig-0.17.0
<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token environment constant">$PATH</span><span class="token builtin class-name">:</span><span class="token variable">$PIG_HOME</span>/bin
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>输入source /etc/profile使环境变量配置生效。</p> <p>接下来配置 pig.properties。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd  /home/hadoop/pig/pig-0.17.0/conf
vim  pig.properties
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>在文件最后加</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#set mr properties
fs.defaultFS=hdfs://192.168.188.100（这里写自己的ip）:9000
mapreduce.framework.name=yarn
yarn.resourcemanager.address=192.168.188.102（这里也是自己的ip）:8032
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="使用实例"><a href="#使用实例" class="header-anchor">¶</a> 使用实例</h2> <p>先将文件放到数据文件data1和data2放到hdfs路径下</p> <img src="/images/hadoop/hdfs.png" width="30%" height="auto" loading="lazy" alt="hdfs" style="display:block;margin:2.2rem auto;max-width:100%;" data-v-2d939f46> <h3 id="filter操作"><a href="#filter操作" class="header-anchor">¶</a> Filter操作</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>grunt&gt; A = LOAD '/test/data.txt' AS(a1:int,a2:int,a3:int);
X = FILTER A BY a3 == 3;
X = FILTER  A  BY  (a1  ==  8)  OR  (NOT  (a2+a3  &gt;  a1));
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><img src="/images/hadoop/filter1.png" width="100%" height="auto" loading="lazy" alt="filter" style="display:block;margin:2.2rem auto;max-width:100%;" data-v-2d939f46> <img src="/images/hadoop/filter2.png" width="100%" height="auto" loading="lazy" alt="filter" style="display:block;margin:2.2rem auto;max-width:100%;" data-v-2d939f46> <h3 id="join操作"><a href="#join操作" class="header-anchor">¶</a> Join操作</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>grunt&gt;  A  =  LOAD  'data1'  AS  (a1:int,a2:int,a3:int);
grunt&gt;  B  =  LOAD  'data2'  AS  (b1:int,b2:int);
grunt&gt;  X  =  JOIN  A  BY  a1,  B  BY  b1；
grunt&gt;  DUMP  X;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><img src="/images/hadoop/join-1.png" width="100%" height="auto" loading="lazy" alt="join" style="display:block;margin:2.2rem auto;max-width:100%;" data-v-2d939f46> <img src="/images/hadoop/join-2.png" width="100%" height="auto" loading="lazy" alt="join" style="display:block;margin:2.2rem auto;max-width:100%;" data-v-2d939f46> <h3 id="order-by操作"><a href="#order-by操作" class="header-anchor">¶</a> Order by操作</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>grunt&gt;  A  =  LOAD  'data'  AS  (a1:int,a2:int,a3:int);
grunt&gt;  X  =  ORDER  A  BY  a3  
grunt&gt;  DUMP  X;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><img src="/images/hadoop/order-by-1.png" width="100%" height="auto" loading="lazy" alt="order-by" style="display:block;margin:2.2rem auto;max-width:100%;" data-v-2d939f46> <img src="/images/hadoop/order-by-2.png" width="100%" height="auto" loading="lazy" alt="order-by" style="display:block;margin:2.2rem auto;max-width:100%;" data-v-2d939f46> <h3 id="group操作"><a href="#group操作" class="header-anchor">¶</a> Group操作</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>A  =  load  'student'  AS  (name:chararray,age:int,gpa:float);
DESCRIBE  A;
A:  {name:  chararray,age:  int,gpa:  float}
DUMP  A;
B  =  GROUP  A  BY  age；
DESCRIBE  B；
ILLUSTRATE  B；
DUMP  B;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><img src="/images/hadoop/group1.png" width="100%" height="auto" loading="lazy" alt="group-by" style="display:block;margin:2.2rem auto;max-width:100%;" data-v-2d939f46> <img src="/images/hadoop/group2.png" width="100%" height="auto" loading="lazy" alt="group-by" style="display:block;margin:2.2rem auto;max-width:100%;" data-v-2d939f46> <img src="/images/hadoop/group3.png" width="100%" height="auto" loading="lazy" alt="group-by" style="display:block;margin:2.2rem auto;max-width:100%;" data-v-2d939f46> <img src="/images/hadoop/group4.png" width="100%" height="auto" loading="lazy" alt="group-by" style="display:block;margin:2.2rem auto;max-width:100%;" data-v-2d939f46> <img src="/images/hadoop/group5.png" width="100%" height="auto" loading="lazy" alt="group-by" style="display:block;margin:2.2rem auto;max-width:100%;" data-v-2d939f46></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/hadoop/hbase.html" class="prev">
        HBase
      </a></span> <span class="next"><a href="/hadoop/spark.html">
        Spark
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.7696aff8.js" defer></script><script src="/assets/js/2.3c301967.js" defer></script><script src="/assets/js/22.8c1d8730.js" defer></script><script src="/assets/js/11.7aea8a94.js" defer></script>
  </body>
</html>
